Most of the UDP code is taken from :

http://gafferongames.com/networking-for-game-programmers/sending-and-receiving-packets/

A big thanks to Glenn Fiedler.